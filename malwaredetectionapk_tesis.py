# -*- coding: utf-8 -*-
"""MalwaredetectionAPK_tesis.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_QZGU6tAFWYfWx6a00Kw9wi-g3s8yY5e
"""

import tensorflow as tf
from tensorflow import keras
import numpy as np
import pandas
from keras.models import Sequential
from keras.layers import Dense

dataframe = pandas.read_csv('/dataSet_APKManifest_oficial_147_0-1.csv')
rawData = dataframe.values
header=dataframe.head()
features = rawData[:,2:]
labels = rawData[:,1]
features=np.array(features,dtype=float)
#labels=np.array(labels,dtype=float)
model = create_model()
model = Sequential()
model.add(Dense(12, input_dim=370, kernel_initializer='uniform', activation='relu'))
model.add(Dense(8, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))

model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

model.fit(features, labels, epochs=4000, batch_size=10)
scores = model.evaluate(features, labels
model.save('CNN_147_REGISTROS.h5')
print("%s: %.2f%%" % (model.metrics_names[1], scores[1] * 100))
